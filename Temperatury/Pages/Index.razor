@page "/"

<style>
    .fade-in-out {
        transition: opacity 0.5s ease-in-out;
        opacity: 0;
    }

        .fade-in-out.loaded {
            opacity: 1;
        }

        .fade-in-out.not-loaded {
            opacity: 0;
        }
</style>

<MudTabs Elevation="2" Rounded="true" Centered="true" Class="my-6" Color="Color.Dark" Outlined="true" @ref="tabs">
    <MudTabPanel Icon="@Icons.Material.Filled.CreditCard" Text="Karty" BadgeColor="Color.Error" Style="margin-bottom: 0px;margin-top: 0px;" ID="@("tab_cards")" OnClick="() => CardSizeChanged((byte)cardSize)">
        <MudGrid Justify="Justify.Center">
            <MudItem xs="12">
                @if (_dataNotActual)
                {
                    <MudAlert Style="width:100%" Variant="Variant.Filled" Severity="Severity.Error">
                        Dane nieaktualne
                    </MudAlert>
                }
            </MudItem>
            <MudItem xs="6" Style="margin-top: 0px;">
                <MudRadioGroup T="int" SelectedOptionChanged="@CardSizeChanged">
                    <MudGrid Justify="Justify.SpaceBetween">
                        <MudRadio Option="1" Color="Color.Primary" UnCheckedColor="Color.Default" Placement="Placement.Bottom" Size="Size.Large" Dense="true">Małe</MudRadio>
                        <MudRadio Option="2" Color="Color.Primary" UnCheckedColor="Color.Default" Placement="Placement.Bottom" Size="Size.Large" Dense="true">Średnie</MudRadio>
                        <MudRadio Option="3" Color="Color.Primary" UnCheckedColor="Color.Default" Placement="Placement.Bottom" Size="Size.Large" Dense="true">Duże</MudRadio>
                    </MudGrid>
                </MudRadioGroup>
            </MudItem>

            <MudItem xs="12" Style="width:100%" Class="@(_refreshed ? "fade-in-out loaded" : "fade-in-out not-loaded")">
                <MudGrid Justify="Justify.Center" Spacing="1">
                    @if (_loaded)
                    {
                        @foreach (var sensor in _sensors)
                        {
                            <MudItem lg="@_cardSizeForLg" md="@_cardSizeForMd" @onclick="@(() => Activate("tab_details", sensor))" Style="width:100%">
                                <CardWithTemperature Sensor="sensor" @ref="AddChildComponentInstance" cardSize="cardSize" />
                            </MudItem>
                        }
                    }
                </MudGrid>
            </MudItem>
        </MudGrid>
    </MudTabPanel>
    <MudTabPanel Icon="@Icons.Material.Filled.Map" Text="Mapa" BadgeColor="Color.Success" ID="@("tab_map")">
        <CascadingValue Value="_sensors">
            <MapWithSensors />
        </CascadingValue>
    </MudTabPanel>
    <MudTabPanel Icon="@Icons.Material.Filled.DataUsage" Text="Raport" BadgeColor="Color.Success" ID="@("tab_report")" OnClick="@(() => _timer.Dispose())">
        <ReportPage />
    </MudTabPanel>
    <MudTabPanel Icon="@Icons.Material.Filled.Details" Text="Szczegóły" BadgeColor="Color.Success" ID="@("tab_details")" OnClick="@(() => _timer.Dispose())">
        <CascadingValue Value="CurrentSelectedSensor">
            <CascadingValue Value="_sensors">
                <SensorPage />
            </CascadingValue>
        </CascadingValue>
    </MudTabPanel>
</MudTabs>